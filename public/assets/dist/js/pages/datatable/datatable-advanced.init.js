var frenchTranslation = {
  
  "emptyTable": "Aucune donnée disponible dans le tableau",
  "loadingRecords": "Chargement...",
  "processing": "Traitement...",
  "select": {
      "rows": {
          "_": "%d lignes sélectionnées",
          "1": "1 ligne sélectionnée"
      },
      "cells": {
          "1": "1 cellule sélectionnée",
          "_": "%d cellules sélectionnées"
      },
      "columns": {
          "1": "1 colonne sélectionnée",
          "_": "%d colonnes sélectionnées"
      }
  },
  "autoFill": {
      "cancel": "Annuler",
      "fill": "Remplir toutes les cellules avec <i>%d<\/i>",
      "fillHorizontal": "Remplir les cellules horizontalement",
      "fillVertical": "Remplir les cellules verticalement"
  },
  "searchBuilder": {
      "conditions": {
          "date": {
              "after": "Après le",
              "before": "Avant le",
              "between": "Entre",
              "empty": "Vide",
              "not": "Différent de",
              "notBetween": "Pas entre",
              "notEmpty": "Non vide",
              "equals": "Égal à"
          },
          "number": {
              "between": "Entre",
              "empty": "Vide",
              "gt": "Supérieur à",
              "gte": "Supérieur ou égal à",
              "lt": "Inférieur à",
              "lte": "Inférieur ou égal à",
              "not": "Différent de",
              "notBetween": "Pas entre",
              "notEmpty": "Non vide",
              "equals": "Égal à"
          },
          "string": {
              "contains": "Contient",
              "empty": "Vide",
              "endsWith": "Se termine par",
              "not": "Différent de",
              "notEmpty": "Non vide",
              "startsWith": "Commence par",
              "equals": "Égal à",
              "notContains": "Ne contient pas",
              "notEndsWith": "Ne termine pas par",
              "notStartsWith": "Ne commence pas par"
          },
          "array": {
              "empty": "Vide",
              "contains": "Contient",
              "not": "Différent de",
              "notEmpty": "Non vide",
              "without": "Sans",
              "equals": "Égal à"
          }
      },
      "add": "Ajouter une condition",
      "button": {
          "0": "Recherche avancée",
          "_": "Recherche avancée (%d)"
      },
      "clearAll": "Effacer tout",
      "condition": "Condition",
      "data": "Donnée",
      "deleteTitle": "Supprimer la règle de filtrage",
      "logicAnd": "Et",
      "logicOr": "Ou",
      "title": {
          "0": "Recherche avancée",
          "_": "Recherche avancée (%d)"
      },
      "value": "Valeur",
      "leftTitle": "Désindenter le critère",
      "rightTitle": "Indenter le critère"
  },
  "searchPanes": {
      "clearMessage": "Effacer tout",
      "count": "{total}",
      "title": "Filtres actifs - %d",
      "collapse": {
          "0": "Volet de recherche",
          "_": "Volet de recherche (%d)"
      },
      "countFiltered": "{shown} ({total})",
      "emptyPanes": "Pas de volet de recherche",
      "loadMessage": "Chargement du volet de recherche...",
      "collapseMessage": "Réduire tout",
      "showMessage": "Montrer tout"
  },
  "buttons": {
      "collection": "Collection",
      "colvis": "Visibilité colonnes",
      "colvisRestore": "Rétablir visibilité",
      "copy": "Copier",
      "copySuccess": {
          "1": "1 ligne copiée dans le presse-papier",
          "_": "%d lignes copiées dans le presse-papier"
      },
      "copyTitle": "Copier dans le presse-papier",
      "csv": "CSV",
      "excel": "Excel",
      "pageLength": {
          "-1": "Afficher toutes les lignes",
          "_": "Afficher %d lignes",
          "1": "Afficher 1 ligne"
      },
      "pdf": "PDF",
      "print": "Imprimer",
      "copyKeys": "Appuyez sur ctrl ou u2318 + C pour copier les données du tableau dans votre presse-papier.",
      "createState": "Créer un état",
      "removeAllStates": "Supprimer tous les états",
      "removeState": "Supprimer",
      "renameState": "Renommer",
      "savedStates": "États sauvegardés",
      "stateRestore": "État %d",
      "updateState": "Mettre à jour"
  },
  "decimal": ",",
  "datetime": {
      "previous": "Précédent",
      "next": "Suivant",
      "hours": "Heures",
      "minutes": "Minutes",
      "seconds": "Secondes",
      "unknown": "-",
      "amPm": [
          "am",
          "pm"
      ],
      "months": {
          "0": "Janvier",
          "2": "Mars",
          "3": "Avril",
          "4": "Mai",
          "5": "Juin",
          "6": "Juillet",
          "8": "Septembre",
          "9": "Octobre",
          "10": "Novembre",
          "1": "Février",
          "11": "Décembre",
          "7": "Août"
      },
      "weekdays": [
          "Dim",
          "Lun",
          "Mar",
          "Mer",
          "Jeu",
          "Ven",
          "Sam"
      ]
  },
  "editor": {
      "close": "Fermer",
      "create": {
          "title": "Créer une nouvelle entrée",
          "button": "Nouveau",
          "submit": "Créer"
      },
      "edit": {
          "button": "Editer",
          "title": "Editer Entrée",
          "submit": "Mettre à jour"
      },
      "remove": {
          "button": "Supprimer",
          "title": "Supprimer",
          "submit": "Supprimer",
          "confirm": {
              "_": "Êtes-vous sûr de vouloir supprimer %d lignes ?",
              "1": "Êtes-vous sûr de vouloir supprimer 1 ligne ?"
          }
      },
      "multi": {
          "title": "Valeurs multiples",
          "info": "Les éléments sélectionnés contiennent différentes valeurs pour cette entrée. Pour modifier et définir tous les éléments de cette entrée à la même valeur, cliquez ou tapez ici, sinon ils conserveront leurs valeurs individuelles.",
          "restore": "Annuler les modifications",
          "noMulti": "Ce champ peut être modifié individuellement, mais ne fait pas partie d'un groupe. "
      },
      "error": {
          "system": "Une erreur système s'est produite (<a target=\"\\\" rel=\"nofollow\" href=\"\\\">Plus d'information<\/a>)."
      }
  },
  "stateRestore": {
      "removeSubmit": "Supprimer",
      "creationModal": {
          "button": "Créer",
          "order": "Tri",
          "paging": "Pagination",
          "scroller": "Position du défilement",
          "search": "Recherche",
          "select": "Sélection",
          "columns": {
              "search": "Recherche par colonne",
              "visible": "Visibilité des colonnes"
          },
          "name": "Nom :",
          "searchBuilder": "Recherche avancée",
          "title": "Créer un nouvel état",
          "toggleLabel": "Inclus :"
      },
      "renameButton": "Renommer",
      "duplicateError": "Il existe déjà un état avec ce nom.",
      "emptyError": "Le nom ne peut pas être vide.",
      "emptyStates": "Aucun état sauvegardé",
      "removeConfirm": "Voulez vous vraiment supprimer %s ?",
      "removeError": "Échec de la suppression de l'état.",
      "removeJoiner": "et",
      "removeTitle": "Supprimer l'état",
      "renameLabel": "Nouveau nom pour %s :",
      "renameTitle": "Renommer l'état"
  },
  "info": "Affichage de _START_ à _END_ sur _TOTAL_ entrées",
  "infoEmpty": "Affichage de 0 à 0 sur 0 entrées",
  "infoFiltered": "(filtrées depuis un total de _MAX_ entrées)",
  "lengthMenu": "Afficher _MENU_ entrées",
  "paginate": {
      "first": "Première",
      "last": "Dernière",
      "next": "Suivante",
      "previous": "Précédente"
  },
  "zeroRecords": "Aucune entrée correspondante trouvée",
  "aria": {
      "sortAscending": " : activer pour trier la colonne par ordre croissant",
      "sortDescending": " : activer pour trier la colonne par ordre décroissant"
  },
  "infoThousands": " ",
  "search": "Rechercher :",
  "thousands": " "

};
//=============================================//
//    File export                              //
//=============================================//
$("#file_export").DataTable({
  
  dom: "Bfrtip",
  buttons: ["copy", "excel"],
  scrollX: true,
  language: frenchTranslation,
  scrollCollapse: true,
});
$(
  ".buttons-copy, .buttons-csv, .buttons-print, .buttons-pdf, .buttons-excel"
).addClass("btn btn-primary mr-1");



$("#courrier_jourss").DataTable({
  
  dom: "Bfrtip",
  scrollX: true,
  scrollY: "350px",
  buttons: ["copy", "excel"],
  order: [], 
  scrollCollapse: true,
  
  language: frenchTranslation,
});
$(
  ".buttons-copy, .buttons-csv, .buttons-print, .buttons-pdf, .buttons-excel"
).addClass("btn btn-primary mr-1");








$("#courrier_enregistrersss").DataTable({
  
  dom: "Bfrtip",
  scrollX: true,
  scrollY: "350px",
  buttons: ["copy", "excel"],
  order: [], 
  scrollCollapse: true,
  
  language: frenchTranslation,
});
$(
  ".buttons-copy, .buttons-csv, .buttons-print, .buttons-pdf, .buttons-excel"
).addClass("btn btn-primary mr-1");





$("#courrier_encourssss").DataTable({
  dom: 'Bfrtip',
  scrollX: true,
  scrollY: "300px",
  scrollCollapse: true,
   // Activez le mode collapse
  
  
  buttons: [
    
    {
      extend: 'copy',
      className: 'btn btn-primary mr-1',
    },
    
    {
      extend: 'excel',
      className: 'btn btn-primary mr-1',
    },
  ],
  order: [], 
  language: frenchTranslation,
  
});





$("#courrier_traitersss").DataTable({
  
  dom: "Bfrtip",
  scrollX: true,
  scrollY: "350px",
  buttons: ["copy", "excel"],
  order: [], 
  scrollCollapse: true,
  
  language: frenchTranslation,
});
$(
  ".buttons-copy, .buttons-csv, .buttons-print, .buttons-pdf, .buttons-excel"
).addClass("btn btn-primary mr-1");


$("#table_encour").DataTable({
  
  dom: "Bfrtip",
  buttons: ["copy", "excel"],
  scrollX: true,
  scrollY: "350px",
  order: [], 
  scrollCollapse: true,
  
  language: frenchTranslation,
  
});
$(
  ".buttons-copy, .buttons-csv, .buttons-print, .buttons-pdf, .buttons-excel"
).addClass("btn btn-primary mr-1");


$("#table_enregitrement").DataTable({
  
  dom: "Bfrtip",
  buttons: ["copy", "excel"],
  scrollX: true,
  scrollY: "300px",
  order: [], 
  scrollCollapse: true,
  
  language: frenchTranslation,
});
$(
  ".buttons-copy, .buttons-csv, .buttons-print, .buttons-pdf, .buttons-excel"
).addClass("btn btn-primary mr-1");



$("#table_traite").DataTable({
  
  dom: "Bfrtip",
  scrollX: true,
  scrollY: "300px",
  order: [], 
  scrollCollapse: true,
  
  buttons: ["copy", "excel"],
  language: frenchTranslation,

  
});
$(
  ".buttons-copy, .buttons-csv, .buttons-print, .buttons-pdf, .buttons-excel"
).addClass("btn btn-primary mr-1");








$("#facture_encoursss").DataTable({
  dom: 'Bfrtip',
  scrollX: true,
  scrollY: "300px",
   // Activez le mode collapse
  
  
  buttons: [
    
    {
      extend: 'copy',
      className: 'btn btn-primary mr-1',
    },
    
    {
      extend: 'excel',
      className: 'btn btn-primary mr-1',
    },
  ],
  order: [], 
  language: frenchTranslation,
  initComplete: function () {
    this.api()
      .columns()
      .every(function () {
        let column = this;
        if (column.header().textContent.trim() === 'Etat') {
          // Créez un label pour le select
          let label = document.createElement('label');
          label.textContent = 'Filtrer par État:';
          label.htmlFor = 'etatSelect'; // Lier le label au select par l'attribut "for"

          let select = document.createElement('select');
          select.id = 'etatSelect'; // Assurez-vous que l'ID correspond à l'attribut "for" du label
          select.className = 'form-select me-sm-1';
          select.add(new Option('Tous'));
          column
            .data()
            .unique()
            .sort()
            .each(function (d, j) {
              select.add(new Option(d));
            });
          select.addEventListener('change', function () {
            var val = DataTable.util.escapeRegex(select.value);

            // Modifiez la recherche en fonction de la valeur sélectionnée
            if (val === 'Tous') {
              column
                .search('', true, false)
                .draw();
            } else {
              column
                .search(val ? '^' + val + '$' : '', true, false)
                .draw();
            }
          });

          // Créez un div pour contenir le label et le sélecteur de filtre
          let filterContainer = document.createElement('div');
          filterContainer.className = 'col-md-1'; // Utilisez la classe 'd-flex' pour aligner les éléments horizontalement
          filterContainer.appendChild(label);
          filterContainer.appendChild(select);

          // Ajoutez le sélecteur de filtre à la barre d'outils
          document.querySelector('.dt-buttons').appendChild(filterContainer);
        }
      });
  },
});




$("#facture_enregitrementsss").DataTable({
  
  dom: "Bfrtip",
  scrollX: true,
  scrollY: "300px",
  buttons: ["copy", "excel"],
  order: [], 
  scrollCollapse: true,
  
  language: frenchTranslation,
});
$(
  ".buttons-copy, .buttons-csv, .buttons-print, .buttons-pdf, .buttons-excel"
).addClass("btn btn-primary mr-1");




$("#facture_enregitrementss").DataTable({
  serverSide: true,
  deferRender: true,
  dom: 'Bfrtip',
  scrollY: '300px',
  scrollX: true,
  buttons: ['copy', 'excel'],
  language: frenchTranslation,
  order: [],
  scrollCollapse: true,
  ajax: {
    url: "{{ route('factures.enregistrement-table') }}",
    type: 'GET',
    error: function(xhr, error, thrown) {
        console.log('Erreur lors de la récupération des données : ', error, thrown);
    },
},
  processing: true,
  columns: [
      // Configurez ici les colonnes de votre DataTable
      { data: 'id', name: 'id' },
      { data: 'numero_facture', name: 'numero_facture' },
      { data: 'fournisseur', name: 'fournisseur' },
      {
          data: null,
          name: 'actions',
          orderable: false,
          searchable: false,
          render: function (data, type, full, meta) {
              return `
             <span class="mb-1 badge bg-info text-dark" >FIN</span>
              `;
          }
      },
      { data: 'date_facture', name: 'date_facture',
          render: DataTable.render.date('DD/MM/YYYY')
},
{ data: 'date_arriver_facture', name: 'date_arriver_facture',
          render: DataTable.render.date('DD/MM/YYYY')
},
{
data: 'montant',
name: 'montant',
render: function(data, type, row, meta) {
  // Si le type est "display", formatez la valeur
  if (type === 'display') {
      // Utilisez la fonction toLocaleString pour ajouter une virgule pour les milliers
      var formattedValue = parseFloat(data).toLocaleString('fr-FR', {
          minimumFractionDigits: 2, // Affiche toujours 2 décimales
          maximumFractionDigits: 2, // Affiche toujours 2 décimales
      });

      // Supprimez ".00" des nombres entiers
      formattedValue = formattedValue.replace(/\,00$/, '');

      return formattedValue;
  }
  return data;
}
},

      { data: 'devise', name: 'devise' },
      { data: 'date_enregistrement', name: 'date_enregistrement' },
     
      
  ]
});







//=============================================//
//    Users                              //
//=============================================//
$("#users").DataTable({
  
  dom: "Bfrtip",
  
  buttons: ["copy", "excel"],
  scrollCollapse: true,
  language: frenchTranslation,

  
});
$(
  ".buttons-copy, .buttons-csv, .buttons-print, .buttons-pdf, .buttons-excel"
).addClass("btn btn-primary mr-1");


//=============================================//
//   roles                           //
//=============================================//
$("#roles").DataTable({
  
  dom: "Bfrtip",
  
  buttons: ["copy", "excel"],
  scrollCollapse: true,
  language: frenchTranslation,

  
});
$(
  ".buttons-copy, .buttons-csv, .buttons-print, .buttons-pdf, .buttons-excel"
).addClass("btn btn-primary mr-1");


//==================================================//
//  Show / hide columns dynamically                 //
//==================================================//

var table = $("#show_hide_col").DataTable({
  scrollY: "200px",
  paging: false,
});

$("a.toggle-vis").on("click", function (e) {
  e.preventDefault();

  // Get the column API object
  /*var column = table.column($(this).attr('data-column'));*/
  var column = $("#show_hide_col")
    .dataTable()
    .api()
    .column($(this).attr("data-column"));
  // Toggle the visibility
  column.visible(!column.visible());
});

//=============================================//
//    Column rendering                         //
//=============================================//
$("#col_render").DataTable({
  columnDefs: [
    {
      // The `data` parameter refers to the data for the cell (defined by the
      // `data` option, which defaults to the column being worked with, in
      // this case `data: 0`.
      render: function (data, type, row) {
        return data + " (" + row[3] + ")";
      },
      targets: 0,
    },
    { visible: false, targets: [3] },
  ],
});

//=============================================//
//     Row grouping                            //
//=============================================//
var table = $("#row_group").DataTable({
  pageLength: 10,
  columnDefs: [{ visible: false, targets: 2 }],
  order: [[2, "asc"]],
  displayLength: 25,
  drawCallback: function (settings) {
    var api = this.api();
    var rows = api.rows({ page: "current" }).nodes();
    var last = null;

    api
      .column(2, { page: "current" })
      .data()
      .each(function (group, i) {
        if (last !== group) {
          $(rows)
            .eq(i)
            .before(
              '<tr class="group"><td colspan="5">' + group + "</td></tr>"
            );

          last = group;
        }
      });
  },
});

//=============================================//
// Order by the grouping
//=============================================//
$("#row_group tbody").on("click", "tr.group", function () {
  var currentOrder = table.order()[0];
  if (currentOrder[0] === 2 && currentOrder[1] === "asc") {
    table.order([2, "desc"]).draw();
  } else {
    table.order([2, "asc"]).draw();
  }
});

//=============================================//
//    Multiple table control element           //
//=============================================//
$("#multi_control").DataTable({
  dom: '<"top"iflp<"clear">>rt<"bottom"iflp<"clear">>',
});

//=============================================//
//    DOM/jquery events                        //
//=============================================//
var table = $("#dom_jq_event").DataTable();

$("#dom_jq_event tbody").on("click", "tr", function () {
  var data = table.row(this).data();
  alert("You clicked on " + data[0] + "'s row");
});

//=============================================//
//    Language File                            //
//=============================================//
$("#lang_file").DataTable({
  language: {
    url: "../../dist/js/pages/datatable/German.json",
  },
});

//=============================================//
//    Complex headers with column visibility   //
//=============================================//

$("#complex_head_col").DataTable({
  columnDefs: [
    {
      visible: false,
      targets: -1,
    },
  ],
});

//=============================================//
//    Setting defaults                         //
//=============================================//
var defaults = {
  searching: false,
  ordering: false,
};

$("#setting_defaults").dataTable($.extend(true, {}, defaults, {}));

//=============================================//
//    Footer callback                          //
//=============================================//
$("#footer_callback").DataTable({
  footerCallback: function (row, data, start, end, display) {
    var api = this.api(),
      data;

    // Remove the formatting to get integer data for summation
    var intVal = function (i) {
      return typeof i === "string"
        ? i.replace(/[\$,]/g, "") * 1
        : typeof i === "number"
        ? i
        : 0;
    };

    // Total over all pages
    total = api
      .column(4)
      .data()
      .reduce(function (a, b) {
        return intVal(a) + intVal(b);
      }, 0);

    // Total over this page
    pageTotal = api
      .column(4, { page: "current" })
      .data()
      .reduce(function (a, b) {
        return intVal(a) + intVal(b);
      }, 0);

    // Update footer
    $(api.column(4).footer()).html(
      "$" + pageTotal + " ( $" + total + " total)"
    );
  },
});

